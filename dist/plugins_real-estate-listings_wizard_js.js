(self.webpackChunksquarehero_plugin_dashboard=self.webpackChunksquarehero_plugin_dashboard||[]).push([["plugins_real-estate-listings_wizard_js"],{"./plugins/real-estate-listings/wizard.js":()=>{eval("/**\n * SquareHero Real Estate Listings Plugin - Setup Wizard\n * This file handles the initial setup wizard for the Real Estate Listings plugin\n * With improved conditional navigation\n */\n\n(function () {\n  console.log(\"âœ“ REAL ESTATE WIZARD SCRIPT LOADED\");\n\n  // Create the wizard manager\n  const RealEstateWizard = {\n    /*Initialize the wizard*/\n    initialize: function () {\n      console.log('Initializing Real Estate Listings Wizard');\n\n      // Check if wizard should be shown\n      if (!this.shouldShowWizard()) {\n        console.log('Wizard already completed, skipping initialization');\n        return false;\n      }\n\n      // Register wizard schema with settings registry\n      this.registerWizardSchema();\n\n      return true;\n    },\n\n    /**\n     * Check if wizard should be shown\n     */\n    shouldShowWizard: function () {\n      // Use the same key format as isWizardSetupRequired uses\n      const wizardCompleted = localStorage.getItem('real-estate-setup-wizard_completed') === 'true';\n      \n      // For development, you can force the wizard to show\n      const forceWizard = localStorage.getItem('force-wizard') === 'true';\n\n      return !wizardCompleted || forceWizard;\n    },\n\n    /**\n     * Mark wizard as completed\n     */\n    markWizardCompleted: function () {\n      // Set both keys for compatibility\n      localStorage.setItem('real-estate-setup-wizard_completed', 'true');\n      localStorage.setItem('real-estate-wizard-completed', 'true');\n      console.log('Wizard marked as completed');\n\n      // Refresh the panel to show regular settings\n      if (window.Dashboard && window.Dashboard.refreshCurrentPanel) {\n        window.Dashboard.refreshCurrentPanel();\n      }\n    },\n\n    /**\n     * Register wizard schema with settings registry\n     */\n    registerWizardSchema: function () {\n      // Define wizard steps\n      const wizardSchema = [\n        {\n          type: 'wizard',\n          id: 'real-estate-setup-wizard', // Change to match the key in isWizardSetupRequired\n          steps: [\n            // Welcome step\n            {\n              id: 'welcome',\n              title: 'Let\\'s get started!',\n              content: 'This wizard will help you set up your Real Estate Listings plugin for your Squarespace site. Before we begin, let us know about your current setup:',\n              image: 'plugins/real-estate-listings/icon.svg',\n              conditional: true, // Mark as conditional step\n              components: [\n                {\n                  type: 'button-group',\n                  id: 'setup-status',\n                  options: [\n                    {\n                      value: 'existing',\n                      label: 'I already have a blog collection with properties',\n                      description: 'You have a Squarespace blog or collection where your property listings are stored',\n                      nextStep: 'existing-collection' // Specify next step ID\n                    },\n                    {\n                      value: 'new',\n                      label: 'I need to set up my properties collection',\n                      description: 'You haven\\'t created a Squarespace blog or collection for your properties yet',\n                      nextStep: 'create-collection' // Specify next step ID\n                    }\n                  ],\n                }\n              ]\n            },\n\n            // Path A: For users with existing collections\n            {\n              id: 'existing-collection',\n              title: 'Connect to Your Existing Collection',\n              content: 'Please specify the URL path of your existing properties collection:',\n              nextStep: 'complete', // Will go to complete after this step\n              components: [\n                {\n                  type: 'text',\n                  id: 'collection-slug',\n                  label: 'Collection URL Path',\n                  default: 'properties',\n                  helpText: 'The URL path of your Squarespace blog collection with property listings'\n                }\n              ]\n            },\n\n            // Path B: For users who need to create a collection\n            {\n              id: 'create-collection',\n              title: 'Create a New Collection',\n              content: 'Let\\'s set up a new collection for your properties. Here\\'s how:',\n              nextStep: 'complete', // Will go to complete after this step\n              components: [\n                {\n                  type: 'text',\n                  id: 'new-collection-name',\n                  label: 'What would you like to name your collection?',\n                  default: 'Properties',\n                  helpText: 'This will be the name of your new Squarespace collection'\n                }\n              ]\n            },\n\n            // Completion step\n            {\n              id: 'complete',\n              title: 'Setup Complete!',\n              content: 'Great job! Your Real Estate Listings plugin is now configured. You can make additional adjustments in the settings panel anytime.',\n              image: 'plugins/real-estate-listings/icon.svg',\n              components: []\n            }\n          ],\n          onComplete: this.onWizardComplete.bind(this),\n          completionCallback: 'realEstateWizardCompleted'\n        }\n      ];\n\n      // Register with the settings registry\n      if (window.Dashboard && window.Dashboard.registerWizardSchema) {\n        window.Dashboard.registerWizardSchema('real-estate-listings', wizardSchema);\n        console.log('Wizard schema registered');\n      } else {\n        console.error('Dashboard.registerWizardSchema method not available');\n      }\n    },\n\n    /**\n     * Handle wizard completion\n     */\n    onWizardComplete: function (form, values) {\n      console.log('Wizard completed with values:', values);\n\n      // Prepare settings to save based on the chosen path\n      const settingsToSave = { ...values };\n\n      // Add a flag to indicate wizard has been completed\n      settingsToSave.wizardCompleted = true;\n\n      // Save the collected values to plugin settings\n      if (window.Dashboard && window.Dashboard.savePluginSettings) {\n        window.Dashboard.savePluginSettings('real-estate-listings', settingsToSave);\n      }\n\n      // Mark wizard as completed\n      this.markWizardCompleted();\n\n      return true;\n    }\n  };\n\n  // Register with Dashboard if available\n  if (typeof window.Dashboard !== 'undefined') {\n    console.log(\"Registering Real Estate Wizard with Dashboard\");\n\n    // Register the wizard with the Dashboard\n    window.Dashboard.PluginRegistry.register('real-estate-listings', 'wizard', RealEstateWizard);\n  }\n\n  // Add global callback that will be called when wizard is complete\n  window.realEstateWizardCompleted = function (values) {\n    console.log('Wizard completed callback with values:', values);\n\n    // Get which path was taken\n    const setupStatus = values['setup-status'] || 'new';\n\n    // Any additional steps needed after wizard completion\n    if (setupStatus === 'new') {\n      console.log('User needs to create a new collection named:', values['new-collection-name']);\n      // Could show instructions for creating collection\n    } else {\n      console.log('User will use existing collection with slug:', values['collection-slug']);\n      // Could verify collection exists or make API call to connect\n    }\n\n    // Refresh the page or panel to show the regular settings\n    if (window.Dashboard && window.Dashboard.refreshCurrentPanel) {\n      setTimeout(() => {\n        window.Dashboard.refreshCurrentPanel();\n      }, 1000); // Small delay to ensure all data is saved\n    }\n  };\n\n  // Initialize the wizard\n  RealEstateWizard.initialize();\n})();\n\n//# sourceURL=webpack://squarehero-plugin-dashboard/./plugins/real-estate-listings/wizard.js?")}}]);